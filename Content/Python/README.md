# Python scripts
Python scripts for ArgonSDK. These can be used within

## build.py
Build script for cooking and packaging subfolders as mods.
- Uses UnrealPak
- Usable in CLI and UE4 Editor Scripting BPs

> If used in a project different from TBL, modify `PROJECT_NAME` in build.py

### Actions
`python build.py cook`: runs iterative cooking

`python build.py pak`: creates a pak file from provided Content subdirectory
- asets inside `<mod_dir>/_Content/` will be packed as content replacement (`..\..\..\TBL\Game\`)

### Usage

#### Settings
Use `-s` argument in `pak` or `cook` commands to save paths to a JSON file.

If no filename is provided, `build.json` is used

`-l` argument reuses valid paths (not specified in command)

#### Example `build.json` file
> Generated by running `build.py pak -s ....`

```json
{
  "uproject_path": "M:/chivmodding_i/SDK/ArgonSDK/TBL.uproject",
  "ue4_root": "H:/epic/UE_4.25/Engine/",
  "mod_dir": "/Game/Mods/AgMods/",
  "dest_dir": "M:/chivmodding_i/SDK/ArgonSDK/Scripts"
}
```
#### Cooking
```shell
usage: build.py cook [-h] [-s [<file.json>]] [-l [<file.json>]] [uproject_path] [ue4_root]

positional arguments:
  uproject_path     path to .uproject file
  ue4_root          path to ue4 ("H:/epic/UE_4.25/Engine/")    Load paths from file (build.json by default)
```
`python build.py cook "M:/ArgonSDK/TBL.uproject" "H:/UE_4.25/Engine"`

`python build.py cook -l` load paths from `build.json` 

`python build.py cook -l second.json`


#### Paking
```shell
usage: build.py pak [-h] [-s [FILE]] [-l [FILE]] mod_name [mod_dir] [dest_dir] [uproject_path] [ue4_root]

positional arguments:
  mod_name       Name of the mod (resulting pak) (or comma separated list)
  mod_dir        mod directory, base directory (ends with /) or comma-separated list. defaults to "/Game/Mods/AgMods/<mod_name>"
  dest_dir       Output directory. Will be created on spawn
  uproject_path  path to .uproject file
  ue4_root       path to ue4 ("H:/epic/UE_4.25/Engine/")
  ```
`python build.py pak MyMod "/Game/Mods/AgMods/" "C:\MyPaks" M:/ArgonSDK/TBL.uproject" "H:/UE_4.25/Engine"`

`python build.py pak MyMod -l`: load paths from `build.json`

##### Paking multiple mods at once
`python build.py pak MyMod,MySecondMod -l`
- looks for `<mod_dir>/MyMod` and `<mod_dir>/MySecondMod`
- `/Game/Mods/AgMods` as fallback if `mod_dir` is not set 

`python build.py pak MyMod,MySecondMod "/Game/ModBase2/" -l`

`python build.py pak MyMod,MySecondMod "/Game/Mods/ModA,/Game/Mods/ModB" -l`


#### Usage in ArgonSDK
###### `Content/Scripts/ModHandling`:
`ModPackerWidget.uasset`: calls `run_cook` on user prompt

`ModMarkerEntryWidget.uasset`: calls `process_mod` on user prompt

## unreal.py
UE4 PythonStubs (generated for Chiv 2.11.1)

to re-generate:

`TBL.uproject -run=PythonOnlineDocs -IncludeEngine -IncludeProject` 

## modtools.py
Helper functions for mod actor creation.
To be called from an editor scripting BP

`create_mod(name, path) -> tuple[Object, Object]`: 
- creates new `ArgonSDKModBase` Actor. Returns new CDO and Asset.
- returns:  `(CDO: Object, Asset: Object)`

`create_mod_marker(name, path)`
- creates new `DA_ModMarker` DataAsset. Returns new CDO and Asset
- returns:  `(CDO: Object, Asset: Object)`

`get_object_cdo(object) -> unreal.Object`
- returns Class Default Object for a given object. 

##### Usage in ArgonSDK
`Content/Scripts/ModHandling/NewModWidget.uasset`:
- uses both methods to create assets and modify default properties.